{% extends 'layout.html' %}
{% set navigation = ['site_admin'] %}

{% block content %}
<form method="GET" action="{{ url_for('.message_list') }}">
    <p>
        <select name="state">
            <option value="" {{ 'selected="selected"' | safe if current_state is none }}>Any status</option>
            {% for (state_num, state_name) in states.items() %}
                <option value="{{ state_num }}" {{ 'selected="selected"' | safe if current_state == state_num}}>{{ state_name }}</option>
            {% endfor %}
        </select>
        <input type="submit" value="Filter" />
        {% for (param, param_val) in form_params.items() %}
            <input type="hidden" name="{{ param }}" value="{{ param_val }}" />
        {% endfor %}
    </p>
</form>

{% if messages %}
    <table>
        <tr>
            <th>Status</th>
            <th>Date (UT)</th>
            <th>Subject</th>
        </tr>
        {% for message in messages %}
        <tr>
            <td>
                {{ message.state }}
            </td>
            <td>{{ message.date | format_datetime }}</td>
            <td><a href="{{ url_for('.message_view', message_id=message.id) }}">{{ message.subject }}</a></td>
        </tr>
        {% endfor %}
    </table>
{% else %}
    <p class="not_present">
        No messages match filter parameters.
    </p>
{% endif %}

<nav>
    <p>
        {% if target_first is not none %}
            <a href="{{ target_first }}">First page</a>
        {% endif %}
        {% if target_next is not none %}
            <a href="{{ target_next }}">Next page</a>
        {% endif %}
    </p>
</nav>
{% endblock %}
